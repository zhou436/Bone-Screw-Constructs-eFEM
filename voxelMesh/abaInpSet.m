function abaInpSet(fid, Part)
% to be optimized
% Print Heading of element sets
fprintf(fid, '** ----------------------------------------------------------------\n');
fprintf(fid, '** \n');
% Print BC sets (side surfaces of the bone sample)
topCoorX = max(Part.Nodes(:,2));
botCoorX = min(Part.Nodes(:,2));
topCoorY = max(Part.Nodes(:,3));
botCoorY = min(Part.Nodes(:,3));
[nodeSide,~] = find(...
    Part.Nodes(:,2)==topCoorX |...
    Part.Nodes(:,2)==botCoorX |...
    Part.Nodes(:,3)==topCoorY |...
    Part.Nodes(:,3)==botCoorY...
    );

fprintf(fid, '*Nset, nset=BoneSide, instance=Bone-1\n');
nodeNum = numel(nodeSide);
nodeNumF = floor(nodeNum/16)*16;
nodeInt = reshape(nodeSide(1:nodeNumF),16,[])';
printEle(fid, nodeInt, 16);
printEle(fid, nodeSide(end-nodeNum+nodeNumF+1:end), nodeNum-nodeNumF);

ScrewRefSet = [...
    '*Node\n'...
    '1,           -2., 2.,          11.\n'...
    '*Nset, nset=ScrewTop, instance=Screw-1\n'...
    '46,    47,    48,    50,    51,   809,   829,   830,   831,   832,   844,   845,   846,   847,   848,   849\n'...
    '850,   851,   852,   853,   854,   855,   856,   857,   858,   859,   860,   861,   862,   877,   878,   879\n'...
    '3202,  3203,  3204,  3205,  3206,  3207,  3208,  3209,  3210,  3211,  3212,  3213,  3214,  3215,  3216,  3217\n'...
    '3218,  3219,  3220,  3221,  3222,  3223,  3224,  3225,  3226,  3227,  3228,  3229,  3230,  3231,  3232,  3233\n'...
    '3234,  3235,  3236,  3237,  3238,  3239,  3240,  3241,  3242,  3243,  3244,  3245,  3246,  3247,  3248,  3249\n'...
    '3250,  3251,  3252,  3253,  6769,  6771,  6773,  7082,  7084,  7086,  7217,  7218,  7347,  7351,  7352,  7517\n'...
    '7519,  7521,  8414,  8416,  8418,  9228,  9231,  9371,  9373,  9375,  9427,  9430,  9790,  9791, 10142, 10144\n'...
    '10146, 10153, 10360, 10361, 10362, 10657, 10660, 10733, 10734, 11729, 11833, 11835, 11837, 11850, 11851, 11853\n'...
    '11860, 12012, 12013, 12450, 12641, 12644, 13487, 13631, 13860, 13862, 14308, 14461, 14727, 14728, 15005, 15007\n'...
    '15009, 15283, 15561, 15563, 15565, 15891, 15892, 16271, 16954, 16955, 16956, 17047, 17048, 17050, 17069, 17070\n'...
    '17311, 17539, 17543, 17544, 17829, 17830, 17831, 18139, 18141, 18143, 18242, 18245, 18247, 18249, 18251, 18500\n'...
    '18575, 18576, 18637, 18638, 18640, 18823, 18824, 18825, 18830, 18831, 19291, 19292, 19507, 19696, 19697, 19698\n'...
    '19914, 20758, 20762, 20763, 20945, 20960, 20962, 20964, 21075, 21182, 21183, 21223, 21224, 21318, 21385, 23045\n'...
    '23348, 23350, 23351, 23353, 25243, 28044, 28223, 28225, 28227, 28974, 29175, 29177, 29178, 29671, 29674, 31394\n'...
    '31396, 31398, 31403, 31421, 32826, 32827, 32829, 33210, 33211, 33861, 33879, 33897, 33898, 33900, 33904, 33906\n'...
    '34003, 34059, 34131, 34620, 34621, 34828, 34926, 35077, 35493, 36394, 37291, 37301, 37302, 37327, 37331, 37694\n'...
    '38792, 39692, 39713, 39714, 39715, 40535, 40598, 40599, 40600, 40676, 40778, 40779, 41165, 41185, 41190, 41193\n'...
    '41287, 41288, 41345, 41347, 41442, 41450, 41458, 41529, 41549, 41565, 41757, 41891, 41946, 41947, 42237, 42273\n'...
    '42294, 42312, 42353, 42368, 42396, 42399, 42401, 42417, 42418, 42420, 42789, 42876, 42952\n'...
    '*Elset, elset=ScrewTop, instance=Screw-1\n'...
    '108,   181,   221,   253,   298,   550,   792,   851,   865,   965,  1090,  1176,  1276,  1304,  1759,  1765\n'...
    '1824,  2016,  2079,  2686,  3036,  3150,  3394,  3550,  3721,  4008,  4067,  4078,  4309,  4460,  4657,  4717\n'...
    '4718,  4814,  4844,  4873,  4936,  4937,  5084,  5166,  5231,  5588,  5648,  5655,  5744,  5760,  6364,  6419\n'...
    '6527,  6742,  7330,  8608,  8978,  9060,  9124,  9283, 10108, 10878, 11100, 11560, 11585, 11590, 11681, 11719\n'...
    '12163, 14017, 14913, 14924, 14951, 15379, 17643, 18444, 18492, 18534, 18598, 18605, 18621, 18714, 18896, 19309\n'...
    '19345, 19413, 19464, 19563, 19565, 19576, 19606, 19729, 19734, 19738, 19771, 19794, 19810, 20107, 20116, 20320\n'...
    '20409, 20713, 20761, 20854, 20858, 20963, 21044, 21097, 21155, 21164, 21168, 21181, 21221, 21286, 21288, 21337\n'...
    '21388, 21390, 21398, 21429, 21431, 21433, 21441, 21454, 21934, 22354, 22631, 22948, 22949, 22951, 23561, 23566\n'...
    '24006, 24684, 24849, 24864, 26144, 26982\n'...
    '*Nset, nset=ScrewTopRef\n'...
    '1,\n'...
    ];
fprintf(fid, ScrewRefSet);

% Print Ending of element sets
fprintf(fid, '** \n');
fprintf(fid, '** ----------------------------------------------------------------\n');

end

function printEle(fid, ele, eleNum)
fprintf(fid, [repmat('%d, ', [1,eleNum]), '\n'], ele');
end